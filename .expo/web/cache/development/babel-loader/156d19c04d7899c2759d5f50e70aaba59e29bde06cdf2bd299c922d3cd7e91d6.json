{"ast":null,"code":"import _asyncToGenerator from \"@babel/runtime/helpers/asyncToGenerator\";\nimport _slicedToArray from \"@babel/runtime/helpers/slicedToArray\";\nimport React, { useState } from 'react';\nimport TouchableOpacity from \"react-native-web/dist/exports/TouchableOpacity\";\nimport StyleSheet from \"react-native-web/dist/exports/StyleSheet\";\nimport Alert from \"react-native-web/dist/exports/Alert\";\nimport Modal from \"react-native-web/dist/exports/Modal\";\nimport View from \"react-native-web/dist/exports/View\";\nimport Text from \"react-native-web/dist/exports/Text\";\nimport { FontAwesome } from '@expo/vector-icons';\nimport * as ImagePicker from 'expo-image-picker';\nimport { useNavigation } from '@react-navigation/native';\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nimport { jsxs as _jsxs } from \"react/jsx-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-runtime\";\nexport function VideoPicker() {\n  var navigation = useNavigation();\n  var _useState = useState(0),\n    _useState2 = _slicedToArray(_useState, 2),\n    progress = _useState2[0],\n    setProgress = _useState2[1];\n  var _useState3 = useState(false),\n    _useState4 = _slicedToArray(_useState3, 2),\n    isUploading = _useState4[0],\n    setIsUploading = _useState4[1];\n  var xhr;\n  var aborted = false;\n  var abortUpload = function abortUpload() {\n    aborted = true;\n    if (xhr) {\n      xhr.abort();\n    }\n  };\n  var openVideoLibrary = function () {\n    var _ref = _asyncToGenerator(function* () {\n      var permissionResult = yield ImagePicker.requestMediaLibraryPermissionsAsync();\n      if (!permissionResult.granted) {\n        Alert.alert('Permission to access media library is required!');\n        return;\n      }\n      var pickerResult = yield ImagePicker.launchImageLibraryAsync({\n        mediaTypes: ImagePicker.MediaTypeOptions.Videos\n      });\n      if (pickerResult.canceled) {\n        return;\n      }\n      setIsUploading(true);\n      var videoUri = pickerResult.uri;\n      console.log(\"Video loaded from library!\");\n      console.log(videoUri);\n      uploadVid(videoUri);\n    });\n    return function openVideoLibrary() {\n      return _ref.apply(this, arguments);\n    };\n  }();\n  var uploadVid = function () {\n    var _ref2 = _asyncToGenerator(function* (uri) {\n      var videoData = `data:video/mp4;base64,${yield toBase64(uri)}`;\n      var data = {\n        video: videoData\n      };\n      var xhr = new XMLHttpRequest();\n      xhr.open('POST', 'https://www.sbdci.de/kpw/uploadvid.php', true);\n      xhr.setRequestHeader('Content-Type', 'application/json');\n      xhr.upload.onprogress = function (event) {\n        if (event.lengthComputable) {\n          var percentComplete = Math.round(event.loaded / event.total * 100);\n          setProgress(percentComplete);\n        }\n      };\n      xhr.onload = function () {\n        if (xhr.status === 200) {\n          console.log(xhr.responseText);\n        } else {\n          console.error(\"Fehler beim Hochladen des Videos\");\n        }\n        setIsUploading(false);\n      };\n      xhr.onerror = function (e) {\n        console.error(\"Fehler beim Hochladen des Videos\", e);\n        setIsUploading(false);\n      };\n      xhr.onabort = function () {\n        console.log(\"Upload was aborted\");\n        setIsUploading(false);\n      };\n      xhr.send(JSON.stringify(data));\n    });\n    return function uploadVid(_x) {\n      return _ref2.apply(this, arguments);\n    };\n  }();\n  var toBase64 = function () {\n    var _ref3 = _asyncToGenerator(function* (uri) {\n      var response = yield fetch(uri);\n      var blob = yield response.blob();\n      return new Promise(function (resolve, reject) {\n        var reader = new FileReader();\n        reader.onloadend = function () {\n          return resolve(reader.result.split(',')[1]);\n        };\n        reader.onerror = reject;\n        reader.readAsDataURL(blob);\n      });\n    });\n    return function toBase64(_x2) {\n      return _ref3.apply(this, arguments);\n    };\n  }();\n  return _jsxs(_Fragment, {\n    children: [_jsx(TouchableOpacity, {\n      style: styles.iconButton,\n      onPress: openVideoLibrary,\n      children: _jsx(FontAwesome, {\n        name: \"video-camera\",\n        size: 32\n      })\n    }), isUploading && _jsx(Modal, {\n      transparent: true,\n      animationType: \"slide\",\n      visible: isUploading,\n      onRequestClose: function onRequestClose() {\n        Alert.alert(\"Modal has been closed.\");\n      },\n      children: _jsx(View, {\n        style: {\n          flex: 1,\n          justifyContent: 'center',\n          alignItems: 'center'\n        },\n        children: _jsxs(View, {\n          style: {\n            width: 300,\n            padding: 20,\n            backgroundColor: 'white',\n            borderRadius: 10,\n            alignItems: 'center'\n          },\n          children: [_jsx(Text, {\n            children: \"Uploading Video...\"\n          }), _jsxs(Text, {\n            children: [progress, \"%\"]\n          }), _jsx(TouchableOpacity, {\n            onPress: abortUpload,\n            children: _jsx(Text, {\n              style: {\n                color: 'red',\n                margin: 10\n              },\n              children: \"Abbrechen\"\n            })\n          })]\n        })\n      })\n    })]\n  });\n}\nvar styles = StyleSheet.create({\n  iconButton: {\n    padding: 10\n  }\n});","map":{"version":3,"names":["React","useState","TouchableOpacity","StyleSheet","Alert","Modal","View","Text","FontAwesome","ImagePicker","useNavigation","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","VideoPicker","navigation","_useState","_useState2","_slicedToArray","progress","setProgress","_useState3","_useState4","isUploading","setIsUploading","xhr","aborted","abortUpload","abort","openVideoLibrary","_ref","_asyncToGenerator","permissionResult","requestMediaLibraryPermissionsAsync","granted","alert","pickerResult","launchImageLibraryAsync","mediaTypes","MediaTypeOptions","Videos","canceled","videoUri","uri","console","log","uploadVid","apply","arguments","_ref2","videoData","toBase64","data","video","XMLHttpRequest","open","setRequestHeader","upload","onprogress","event","lengthComputable","percentComplete","Math","round","loaded","total","onload","status","responseText","error","onerror","e","onabort","send","JSON","stringify","_x","_ref3","response","fetch","blob","Promise","resolve","reject","reader","FileReader","onloadend","result","split","readAsDataURL","_x2","children","style","styles","iconButton","onPress","name","size","transparent","animationType","visible","onRequestClose","flex","justifyContent","alignItems","width","padding","backgroundColor","borderRadius","color","margin","create"],"sources":["/home/dci-student/DCIFolder/WAppV2/WeddingApp2.0/comp/Camera/VideoPicker.js"],"sourcesContent":["import React, { useState } from 'react';\nimport { TouchableOpacity, StyleSheet, Alert, Modal, View, Text } from 'react-native';\nimport { FontAwesome } from '@expo/vector-icons'; \nimport * as ImagePicker from 'expo-image-picker';\nimport { useNavigation } from '@react-navigation/native';\n\nexport function VideoPicker() {\n    const navigation = useNavigation();\n    const [progress, setProgress] = useState(0); // Fortschritt in Prozent\n    const [isUploading, setIsUploading] = useState(false); // Zustand des Uploads\n\n    let xhr;\n    let aborted = false;\n\n    const abortUpload = () => {\n        aborted = true;\n        if (xhr) {\n            xhr.abort();\n        }\n    };\n\n    const openVideoLibrary = async () => {\n        const permissionResult = await ImagePicker.requestMediaLibraryPermissionsAsync();\n        if (!permissionResult.granted) {\n            Alert.alert('Permission to access media library is required!');\n            return;\n        }\n\n        const pickerResult = await ImagePicker.launchImageLibraryAsync({\n            mediaTypes: ImagePicker.MediaTypeOptions.Videos // Hier wählen wir nur Videos aus.\n        });\n        \n        if (pickerResult.canceled) {\n            return;\n        }\n        setIsUploading(true);\n\n        const videoUri = pickerResult.uri;\n        console.log(\"Video loaded from library!\");\n        console.log(videoUri);\n\n        uploadVid(videoUri); // Video nach Auswahl hochladen\n\n        // Hier können Sie navigieren oder etwas anderes mit dem Video tun.\n        // Zum Beispiel:\n        // navigation.navigate('VideoEditor', { videoUri: videoUri });\n    };\n\n    \n    const uploadVid = async (uri) => {\n        let videoData = `data:video/mp4;base64,${await toBase64(uri)}`; \n        \n        let data = {\n            video: videoData\n        };\n\n  \n\n\n        const xhr = new XMLHttpRequest();\n        xhr.open('POST', 'https://www.sbdci.de/kpw/uploadvid.php', true);\n        xhr.setRequestHeader('Content-Type', 'application/json');\n        \n        xhr.upload.onprogress = (event) => {\n            if (event.lengthComputable) {\n                const percentComplete = Math.round((event.loaded / event.total) * 100);\n                setProgress(percentComplete);\n            }\n        };\n\n        xhr.onload = () => {\n            if (xhr.status === 200) {\n                console.log(xhr.responseText);\n            } else {\n                console.error(\"Fehler beim Hochladen des Videos\");\n            }\n            setIsUploading(false);\n        };\n\n        xhr.onerror = (e) => {\n            console.error(\"Fehler beim Hochladen des Videos\", e);\n            setIsUploading(false);\n        };\n\n        xhr.onabort = () => {\n            console.log(\"Upload was aborted\");\n            setIsUploading(false);\n        };\n\n        xhr.send(JSON.stringify(data));\n    };\n\n    const toBase64 = async (uri) => {\n        const response = await fetch(uri);\n        const blob = await response.blob();\n        return new Promise((resolve, reject) => {\n            const reader = new FileReader();\n            reader.onloadend = () => resolve(reader.result.split(',')[1]);\n            reader.onerror = reject;\n            reader.readAsDataURL(blob);\n        });\n    };\n\n    return (\n        <>\n            <TouchableOpacity style={styles.iconButton} onPress={openVideoLibrary}>\n                <FontAwesome name=\"video-camera\" size={32} />\n            </TouchableOpacity>\n            {isUploading && (\n                <Modal\n                    transparent={true}\n                    animationType=\"slide\"\n                    visible={isUploading}\n                    onRequestClose={() => {\n                        Alert.alert(\"Modal has been closed.\");\n                    }}\n                >\n                    <View style={{flex: 1, justifyContent: 'center', alignItems: 'center'}}>\n                        <View style={{width: 300, padding: 20, backgroundColor: 'white', borderRadius: 10, alignItems: 'center'}}>\n                            <Text>Uploading Video...</Text>\n                            <Text>{progress}%</Text>\n                            <TouchableOpacity onPress={abortUpload}>\n                                <Text style={{color: 'red', margin: 10}}>Abbrechen</Text>\n                            </TouchableOpacity>\n                        </View>\n                    </View>\n                </Modal>\n\n            )}\n        </>\n    );\n}\n\nconst styles = StyleSheet.create({\n    iconButton: {\n        padding: 10\n    }\n});"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}